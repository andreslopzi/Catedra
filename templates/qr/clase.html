{% extends 'qr/base.html' %}
{% load staticfiles %}

{% block title %}{{ curso.nombre }}{% endblock %}
{% block head %}
    <script src="{% static "qr/js/angular.min.js" %}"></script>
    <!--<script src="{% static "qr/js/angular.min.js.map" %}"></script>-->
    <script src="{% static "qr/js/qr.angular.js" %}"></script>
    <script src="{% static "qr/js/webcam.js" %}"></script>
    <script src="{% static "qr/js/bc-qr-reader.js" %}"></script>
    <link rel='stylesheet' href="{% static "qr/css/qr.css" %}" />
    <link rel='stylesheet' href="{% static "qr/css/clase.css" %}" />
{% endblock %}
{% block body %}
    <div class="container" ng-app="Scanner" ng-controller="scan-controller">
        <div class="row center">
            <h3>{{ curso.nombre }}</h3>
            <p class="center hora">Inicio: {{ clase.inicio }}  Fin: {{ clase.fin }} </p>
        </div>
        <div clas="row">
            {% if active %}
            <div class="col-sm-4">
                <p>Por favor haga click en el boton para leer un codigo QR. Tambien puede ingresar el documento en el campo y hacer clic en aceptar</p>
                <br>
                <div class="center">
                    <button class="btn btn-success" ng-click="start()">
                        Leer codigo QR
                    </button>
                </div>
                <br>
                <p ng-hide="cameraRequested">El navegador debera pedir permiso para acceder a la camara</p>
                <div class="center">
                  <bc-qr-reader class="qr_camera" active="cameraRequested" on-result="processURLfromQR" on-error="onError" camera-status="cameraIsOn"></bc-qr-reader>
                </div>
                <p ng-show="url">QR Detectado</p>
                {% verbatim %}<p><b>{{ url }}</b></p>{% endverbatim %}
                <h1 ng-bind="mensaje"></h1>
                <!--<select ng-model="select-camera" ng-options="c as c for c in cameras"></select>-->
                <p ng-bind="cameras"></p>
            </div>
            <div class="col-sm-8">
            {% else %}
            <div class="col-sm-12">
            {% endif %}
                <table class="table">
                  <thead class="thead-light">
                    <tr>
                      <th scope="col">Documento</th>
                      <th scope="col">Nombre</th>
                      <th scope="col">Hora Asistencia</th>
                    </tr>
                  </thead>
                  <tbody>
                    {%  for asistencia in asistencias %}
                        <tr>
                          <td>{{ asistencia.estudiante.identificacion }}</td>
                          <td>{{ asistencia.estudiante.nombre }}</td>
                          <td>{{ asistencia.fecha }}</td>
                        </tr>
                    {% endfor %}
                    {% verbatim %}
                    <tr ng-repeat="a in nuevas_asistencias">
                        <td>{{ a.documento }}</td>
                        <td>{{ a.nombre }}</td>
                        <td>{{ a.hora }}</td>
                    </tr>
                    {% endverbatim %}
                  </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock %}